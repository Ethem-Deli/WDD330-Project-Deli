<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login | History Timeline</title>
    <link rel="stylesheet" href="auth.css" />
</head>

<body>
    <main class="auth-container">
        <h2>Login or Register</h2>

        <input type="email" id="email" placeholder="Email" />
        <input type="password" id="password" placeholder="Password" />

        <div class="auth-buttons">
            <button id="loginBtn">Login</button>
            <button id="registerBtn">Register</button>
        </div>

        <p id="authMessage" class="message"></p>
    </main>

    <script type="module">
        import { loginUser, registerUser, observeAuthState } from "./auth.js";

        const emailInput = document.getElementById("email");
        const passwordInput = document.getElementById("password");
        const message = document.getElementById("authMessage");

        document.getElementById("loginBtn").addEventListener("click", async () => {
            try {
                await loginUser(emailInput.value, passwordInput.value);
                message.textContent = "Login successful!";
                window.location.href = "../index.html";
            } catch (err) {
                message.textContent = err.message;
            }
        });

        document.getElementById("registerBtn").addEventListener("click", async () => {
            try {
                await registerUser(emailInput.value, passwordInput.value);
                message.textContent = "Registration successful! You can now log in.";
            } catch (err) {
                message.textContent = err.message;
            }
        });

        // If user already logged in, redirect
        observeAuthState(user => {
            if (user) window.location.href = "../index.html";
        });
    </script>
</body>

</html>